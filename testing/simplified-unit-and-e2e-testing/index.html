<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" /> 
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"> 
<title>Testing Is Documenting: Simplified Unit And E2E testing with WebTau</title>
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-153393045-1', 'auto');
    ga('send', 'pageview');
</script><link rel="stylesheet" type="text/css" href="/blog/static/css/katex.min.css">
<link rel="stylesheet" type="text/css" href="/blog/static/main.css">
<link rel="stylesheet" type="text/css" href="/blog/static/blog-style.css">
<link rel="stylesheet" type="text/css" href="/blog/static/css/global-overrides.css">
<link rel="stylesheet" type="text/css" href="/blog/style.css">
</head>
<link rel="shortcut icon" href="/blog/favicon.png"type="image/ico"/>
<body class="theme-znai-dark">
<script>(function() {
    var themeNameKey = 'znaiTheme';
    var darkThemeName = 'znai-dark';
    var lightThemeName = 'default';

    var znaiTheme = {
        changeHandlers: [],
        addChangeHandler(handler) {
            this.changeHandlers.push(handler);
        },
        removeChangeHandler(handler) {
            var idx = this.changeHandlers.indexOf(handler);
            this.changeHandlers.splice(idx, 1);
        },
        set(name) {
            this.name = name;
            document.body.className = 'theme-' + name;

            var idx = 0;
            var len = this.changeHandlers.length;
            for (; idx < len; idx++) {
                this.changeHandlers[idx](name);
            }
        },
        setExplicitly(name) {
            storeThemeName(name);
            this.set(name);
        },
        setExplicitlyIfNotSetAlready(name) {
            const themeName = getStoredThemeName();
            if (themeName) {
                return
            }

            this.setExplicitly(name)
        },
        toggle() {
            this.setExplicitly(this.name === lightThemeName ? darkThemeName : lightThemeName)
        }
    };

    var mediaThemeName = setLightMatchMediaListenerAndGetThemeName()
    var themeName = getStoredThemeName() || mediaThemeName;
    znaiTheme.set(themeName);

    window.znaiTheme = znaiTheme;

    function getStoredThemeName() {
        return localStorage.getItem(themeNameKey);
    }

    function storeThemeName(name) {
        return localStorage.setItem(themeNameKey, name);
    }

    function setLightMatchMediaListenerAndGetThemeName() {
        if (!window.matchMedia) {
            return darkThemeName;
        }

        var lightQuery = window.matchMedia('(prefers-color-scheme: light)');
        lightQuery.addListener(function (e) {
            const newThemeName = e.matches ? lightThemeName : darkThemeName;
            znaiTheme.setExplicitly(newThemeName);
        });

        return lightQuery.matches ? lightThemeName : darkThemeName;
    }
})()</script>
<div id="znai"><div id="znai-initial-page-loading" style="margin: -20px 0 0 -20px; padding: 0 40px 40px 0; width: 100vw; height: 100vh; display: flex; justify-content: center; align-items: center">
    <div></div>
</div><section style="max-width: 640px; margin-left: auto; margin-right: auto;">
<article>
<header><h1>Business Logic Data Preparation</h1></header>
<p>Business logic testing often involves creating data input and validating logic output. I want to show you how you can simplify complex domain data creation using WebTau API.Throughout this article we will be building a Game Store server and its various business rules.Let's start with implementation and testing of games checkout discount logic.Business department came up with the idea that we should encourage people to buy different game genres. So discount depends on:how many distinct type of games you buy each distinct game type will yield 10% discount, as long as games cost more than $15 no more than three distinct games types will be counted As an example, given the following checkout cart, a user will get a 20% discount: id type price g1 RPG 10 g2 RPG 50 g3 Action 70 g4 Puzzle 10 Let's create a discount calculator to implement the business rule: public class DiscountCalculator { public int calculateDiscountPercentage(List&lt;Game&gt; games) { long numberOfDistinctTypes = games.stream() .filter(game -&gt; game.getPriceUsd().compareTo(BigDecimal.valueOf(15)) &gt; 0) // price filter .map(Game::getType) .distinct() // only distinct game types .count(); long limitedDistinctTypes = Math.min(3, numberOfDistinctTypes); // no more than three return (int) (limitedDistinctTypes * 10); } } To test that code we will need to create a sufficient number of Game instances to make sure we cover:Count only one game per type Count only games with high enough price Should count no more than three distinct types Creating many Game instances is a lot of boilerplate: Game game1 = new Game(); game1.setId(&quot;id1&quot;); game1.setType(&quot;RPG&quot;); game1.setPriceUsd(BigDecimal.valueOf(12)); Game game2 = new Game(); game1.setId(&quot;id2&quot;); game1.setType(&quot;RPG&quot;); game1.setPriceUsd(BigDecimal.valueOf(28)); Game game3 = new Game(); game1.setId(&quot;id3&quot;); game1.setType(&quot;RPG&quot;); game1.setPriceUsd(BigDecimal.valueOf(70)); // .... List&lt;Game&gt; checkoutGames = Arrays.asList(game1, game2, game3); When we deal with boilerplate multiple things can happen:copy pasting and not updating values not creating enough instances To streamline the process of data creation, WebTau provides table API: public class DiscountCalculatorTest { @Test public void discountBasedUniqueGenresAbove15DollarsLimitedBy3() { List&lt;Game&gt; checkoutGames = createGames(table(&quot;id&quot; , &quot;type&quot;, &quot;price&quot;, // WebTau table API to create domain data ___________________________, cell.guid, &quot;RPG&quot;, 12, // cell.guid generated unique id for each row cell.guid, &quot;RPG&quot;, 28, cell.guid, &quot;RPG&quot;, 70, // three games with the same Type to make sure we pick only one distinct even though 2 match price criteria cell.guid, &quot;FPS&quot;, 30, cell.guid, &quot;FPS&quot;, 10, cell.guid, &quot;RTS&quot;, 60, cell.guid, &quot;Sport&quot;, 30)); // extra game type to make sure we stop at 3 int discountPercentage = new DiscountCalculator().calculateDiscountPercentage(checkoutGames); actual(discountPercentage, &quot;discount&quot;).should(equal(30)); // validate the result } } Let's take a look at implementation of createGames : public static List&lt;Game&gt; createGames(TableData table) { // table data is like list of map return table.rowsStream() // you can stream rows .map(GamesData::createGame) .collect(Collectors.toList()); } public static Game createGame(Record row) { Game game = new Game(); game.setId(row.get(&quot;id&quot;)); game.setType(row.get(&quot;type&quot;)); game.setTitle(row.get(&quot;title&quot;, &quot;&quot;)); // default values when not provided game.setPriceUsd(BigDecimal.valueOf((int) row.get(&quot;price&quot;, 0))); return game; // and create domain data you need } By using table and a domain specific methods like createGames you make your tests easier to write, read and maintain.</p>
</article>

<article>
<header><h1>Business Logic Data Validation</h1></header>
<p>We just simplified our data creation process. Now let's see how we can simplify data validation one.This time we will test a recommendation engine. One of its role is to provide a new game to play based on the games you already played. For now the engine will recommend the least played game in the least played type of games.Here is the test: public class GameRecommendationEngineTest { @Test public void shouldRecommendNextGameWhereAccumulatedPerTypeIsLowest() { GamesLibrary library = createLibrary(table(&quot;id&quot;, &quot;type&quot;, &quot;title&quot;, &quot;hoursPlayed&quot;, // create game library with play stats _________________________________________, &quot;g1&quot;, &quot;RPG&quot;, &quot;Divinity 2&quot;, 130, &quot;g2&quot;, &quot;Sport&quot;, &quot;NBA 2023&quot;, 1, &quot;g3&quot;, &quot;JRPG&quot;, &quot;Persona 5&quot;, 300)); GameRecommendationEngine engine = new GameRecommendationEngine(library); actual(engine.recommendNextGame(), &quot;nextGame&quot;).should(equal(map( // assert on Game bean using map &quot;id&quot;, &quot;g2&quot;, &quot;type&quot;, &quot;Sport&quot;, &quot;title&quot;, contain(&quot;2023&quot;), // using a matcher for a field &quot;stats&quot;, map(&quot;hoursPlayed&quot;, 1)))); } } Our current implementation has a bug, and uses incorrect type for the returned game. When mismatch occurs, WebTau output provides all the information you need to understand the issue and highlights important parts of the output: X failed expecting nextGame to equal {&quot;id&quot;: &quot;g2&quot;, &quot;type&quot;: &quot;Sport&quot;, &quot;title&quot;: &lt;contain &quot;2023&quot;&gt;, &quot;stats&quot;: {&quot;hoursPlayed&quot;: 1}}: nextGame.type: actual: &quot;RPG&quot; &lt;java.lang.String&gt; expected: &quot;Sport&quot; &lt;java.lang.String&gt; ^ (39ms) { &quot;id&quot;: &quot;g2&quot;, &quot;priceUsd&quot;: null, &quot;stats&quot;: {&quot;gameId&quot;: &quot;g2&quot;, &quot;hoursPlayed&quot;: 1}, &quot;title&quot;: &quot;NBA 2023&quot;, &quot;type&quot;: **&quot;RPG&quot;** } WebTau did good with an object validation with a nested object. Let's take a look at how it fares with a list of objects.Games Library class has a method to find top N games. It returns a list of games. Let's test it. public class GamesLibraryTest { @Test public void shouldFindTopTwoGames() { GamesLibrary library = createLibrary(table(&quot;id&quot;, &quot;type&quot;, &quot;title&quot;, &quot;hoursPlayed&quot;, &quot;price&quot;, _________________________________________________________, &quot;g1&quot;, &quot;RPG&quot;, &quot;Divinity 2&quot;, 130, 30, &quot;g2&quot;, &quot;Sport&quot;, &quot;NBA 2023&quot;, 1, 40, &quot;g3&quot;, &quot;JRPG&quot;, &quot;Persona 5&quot;, 300, 20, &quot;g4&quot;, &quot;PainAction&quot;, &quot;Elden Ring&quot;, 200, 60)); trace(&quot;all games&quot;, propertiesTable(library.getGames())); // tracing all games when need to debug List&lt;Game&gt; topTwoGames = library.findTopNGames(2); // find top two games as list of game TableData expected = table( &quot;*id&quot;, &quot;type&quot;, &quot;title&quot;, &quot;priceUsd&quot; , &quot;stats&quot;, // expectation as table with key column &lt;id&gt; _____________________________________________________________________________, &quot;g3&quot;, &quot;JRPG&quot;, &quot;Persona 5&quot;, lessThan(60), map(&quot;hoursPlayed&quot;, 300), // using a matcher inside a table cell &quot;g4&quot;, &quot;PainAction&quot;, &quot;Elden Ring&quot;, 60 , map(&quot;hoursPlayed&quot;, 200)); actual(topTwoGames, &quot;top2&quot;).should(equal(expected)); // compare with list of java beans order agnostic } } [tracing] all games id │ priceUsd │ stats │ title │ type &quot;g1&quot; │ null │ {&quot;gameId&quot;: &quot;g1&quot;, &quot;hoursPlayed&quot;: 130} │ &quot;Divinity 2&quot; │ &quot;RPG&quot; &quot;g2&quot; │ null │ {&quot;gameId&quot;: &quot;g2&quot;, &quot;hoursPlayed&quot;: 1} │ &quot;NBA 2023&quot; │ &quot;Sport&quot; &quot;g3&quot; │ null │ {&quot;gameId&quot;: &quot;g3&quot;, &quot;hoursPlayed&quot;: 300} │ &quot;Persona 5&quot; │ &quot;JRPG&quot; &quot;g4&quot; │ null │ {&quot;gameId&quot;: &quot;g4&quot;, &quot;hoursPlayed&quot;: 200} │ &quot;Elden Ring&quot; │ &quot;PainAction&quot; X failed expecting top2 to equal *id │ type │ title │ priceUsd │ stats &quot;g3&quot; │ &quot;JRPG&quot; │ &quot;Persona 5&quot; │ &lt;less than 60&gt; │ {&quot;hoursPlayed&quot;: 300} &quot;g4&quot; │ &quot;PainAction&quot; │ &quot;Elden Ring&quot; │ 60 │ {&quot;hoursPlayed&quot;: 200}: top2[0].priceUsd: actual: null expected: &lt;less than 60&gt; &lt;org.testingisdocumenting.webtau.expectation.equality.LessThanMatcher&gt; top2[1].priceUsd: actual: null expected: 60 &lt;java.lang.Integer&gt; (10ms) id │ priceUsd │ stats │ title │ type &quot;g3&quot; │ **null** │ {&quot;gameId&quot;: &quot;g3&quot;, &quot;hoursPlayed&quot;: 300} │ &quot;Persona 5&quot; │ &quot;JRPG&quot; &quot;g4&quot; │ **null** │ {&quot;gameId&quot;: &quot;g4&quot;, &quot;hoursPlayed&quot;: 200} │ &quot;Elden Ring&quot; │ &quot;PainAction&quot; Using trace method is optional and can be helpful when dealing with complex data to see what's going on. When failure happens, WebTau displays actual complex data and highlights values within that you need to take a look at.We did validation using TableData . Let's take a look at how a property by property validation would look like. List&lt;Game&gt; topTwoGames = library.findTopNGames(2); Game gameOne = topTwoGames.get(0); assertEquals(&quot;g3&quot;, gameOne.getId()); assertEquals(&quot;JRPG&quot;, gameOne.getType()); assertEquals(&quot;Persona 5&quot;, gameOne.getTitle()); assertEquals(BigDecimal.valueOf(20), gameOne.getPriceUsd()); assertEquals(300, gameOne.getStats().getHoursPlayed()); Game gameTwo = topTwoGames.get(1); assertEquals(&quot;g3&quot;, gameOne.getId()); assertEquals(&quot;PainAction&quot;, gameOne.getType()); assertEquals(&quot;Elden Ring&quot;, gameOne.getTitle()); assertEquals(BigDecimal.valueOf(60), gameOne.getPriceUsd()); assertEquals(200, gameOne.getStats().getHoursPlayed()); To contrast it with table approach: TableData expected = table( &quot;*id&quot;, &quot;type&quot;, &quot;title&quot;, &quot;priceUsd&quot; , &quot;stats&quot;, // expectation as table with key column &lt;id&gt; _____________________________________________________________________________, &quot;g3&quot;, &quot;JRPG&quot;, &quot;Persona 5&quot;, lessThan(60), map(&quot;hoursPlayed&quot;, 300), // using a matcher inside a table cell &quot;g4&quot;, &quot;PainAction&quot;, &quot;Elden Ring&quot;, 60 , map(&quot;hoursPlayed&quot;, 200)); When dealing with validation boilerplate code you can face even worse problems than with data preparation:ignore certain fields validation copy and paste wrong values and they match incorrect logic</p>
</article>

<article>
<header><h1>REST API And Database</h1></header>
<p>We tested some business logic and now lets move on to REST API testing. Game server exposes /api/game end-point to list available games. To test it, we will manually insert records into GAME database table and then use http.get request to validate a piece of data. public class GameRestTest { private final DatabaseTable GAME = db.table(&quot;GAME&quot;); // declare GAME table @Test public void fetchListOfGames() { GAME.clear(); // remove all entries from the DB table GAME.insert(table(&quot;id&quot;, &quot;title&quot;, &quot;type&quot;, &quot;priceUsd&quot;, // insert two rows with auto conversion from camelCase to SNAKE_CASE __________________________________, &quot;id1&quot;, &quot;Game One&quot;, &quot;RPG&quot;, 20, &quot;id2&quot;, &quot;Game Two&quot;, &quot;FPS&quot;, 40)); trace(&quot;games from DB&quot;, GAME.query().tableData()); // trace data from DB http.get(&quot;/api/game&quot;, (header, body) -&gt; { // GET call body.get(0).get(&quot;type&quot;).should(equal(&quot;RPG&quot;)); // specific field validation body.should(equal(table(&quot;*id&quot;, &quot;title&quot;, // bulk validation _____________________, &quot;id1&quot;, &quot;Game One&quot;, &quot;id2&quot;, &quot;Game Two&quot;))); }); } } &gt; creating db datasource primary . created db datasource primary (94ms) &gt; running DB update delete from GAME on primary-db . ran DB update delete from GAME on primary-db affected 2 rows (13ms) &gt; inserting 2 rows into primary-db.GAME . inserted 2 rows into primary-db.GAME (10ms) &gt; running DB query SELECT * FROM GAME on primary-db . ran DB query SELECT * FROM GAME on primary-db (6ms) [tracing] games from DB ID │ PRICE_USD │ TITLE │ TYPE &quot;id1&quot; │ 20.00 │ &quot;Game One&quot; │ &quot;RPG&quot; &quot;id2&quot; │ 40.00 │ &quot;Game Two&quot; │ &quot;FPS&quot; &gt; executing HTTP GET http://localhost:8080/api/game . body[0].type equals &quot;RPG&quot; (0ms) . body equals *id │ title &quot;id1&quot; │ &quot;Game One&quot; &quot;id2&quot; │ &quot;Game Two&quot; (1ms) . header.statusCode equals 200 (1ms) response (application/json): [ {&quot;id&quot;: __&quot;id1&quot;__, &quot;title&quot;: __&quot;Game One&quot;__, &quot;type&quot;: __&quot;RPG&quot;__, &quot;priceUsd&quot;: 20.0}, {&quot;id&quot;: __&quot;id2&quot;__, &quot;title&quot;: __&quot;Game Two&quot;__, &quot;type&quot;: &quot;FPS&quot;, &quot;priceUsd&quot;: 40.0} ] . executed HTTP GET http://localhost:8080/api/game (276ms)</p>
</article>

<article>
<header><h1>Reporting</h1></header>
<p>As you may have noticed, WebTau produces a lot of useful output to the console. In addition, it also generates HTML rich self-contained report. A single HTML file anyone can slack or email to your colleagues. Continuous Integration can send it to a chat or put under shared file system, and it will just work. On top of it, the report supports permalink navigation, so you can have a handy link to a specific portion of your test suite.Even when your test passes, it still has plenty of information you can find useful. Here is an example of HTTP response fields your test validated.JSON fields your test touched are marked It marks both bulk and precise field assertion</p>
</article>

<article>
<header><h1>There Is More</h1></header>
<p>There are so many things WebTau can do and I want to share them with you very much. But I want to keep this article short. Head over to https://github.com/testingisdocumenting/webtau WebTau GitHub to learn more aboutREPL mode HTTP Response Coverage Open API Integration Performance Metrics Browser UI testing GraphQL CLI testing Fake and Proxy Servers Personas Test Containers Integration Don't be afraid by the sheer amount of things the tool can do. It is all modular, and you can use only what you need.</p>
</article>

<article>
<header><h1>GitHub And Star WebTau</h1></header>
<p>If you find it interesting, go to https://github.com/testingisdocumenting/webtau WebTau GitHub page and star the project!There is also a link to https://discord.gg/aEHbzXTX6N Discord Server where you can ask any questions or report a bug.</p>
</article>
</section>
</div>
<script type="text/javascript" src="/blog/footer.js"></script>
<script type="text/javascript" src="/blog/toc.js"></script>
<script type="text/javascript" src="/blog/documentation-references.js"></script>
<script type="text/javascript" src="/blog/assets.js"></script>
<script type="text/javascript" src="/blog/static/main.js"></script>
<script type="text/javascript" src="/blog/static/blog-bundle.js"></script>
<script type="text/javascript" src="/blog/tracking.js"></script>
<script type="text/javascript" src="/blog/search-index.js"></script>
<script>
document.getElementById('znai').innerHTML = '';
/*<!--*/
ReactDOM.render(React.createElement(Documentation, {
  "docMeta" : {
    "viewOn" : {
      "title" : "Edit on GitHub",
      "link" : "https://github.com/testingisdocumenting/blog/blob/master/blog-content"
    },
    "id" : "blog",
    "title" : "Testing Is Documenting",
    "type" : "Blog",
    "previewEnabled" : false
  },
  "page" : {
    "type" : "Page",
    "content" : [ {
      "id" : "business-logic-data-preparation",
      "title" : "Business Logic Data Preparation",
      "type" : "Section",
      "content" : [ {
        "type" : "Paragraph",
        "content" : [ {
          "text" : "Business logic testing often involves creating data input and validating logic output. I want to show you how you can simplify complex domain data creation using ",
          "type" : "SimpleText"
        }, {
          "code" : "WebTau",
          "type" : "InlinedCode"
        }, {
          "text" : " API.",
          "type" : "SimpleText"
        } ]
      }, {
        "type" : "Paragraph",
        "content" : [ {
          "text" : "Throughout this article we will be building a Game Store server and its various business rules.",
          "type" : "SimpleText"
        } ]
      }, {
        "presentationParagraph" : "default",
        "type" : "Meta"
      }, {
        "type" : "Paragraph",
        "content" : [ {
          "text" : "Let's start with implementation and testing of games checkout discount logic.",
          "type" : "SimpleText"
        } ]
      }, {
        "presentationParagraph" : "",
        "type" : "Meta"
      }, {
        "type" : "Paragraph",
        "content" : [ {
          "text" : "Business department came up with the idea that we should encourage people to buy different game genres. So discount depends on:",
          "type" : "SimpleText"
        } ]
      }, {
        "bulletMarker" : "*",
        "tight" : true,
        "type" : "BulletList",
        "content" : [ {
          "type" : "ListItem",
          "content" : [ {
            "type" : "Paragraph",
            "content" : [ {
              "text" : "how many distinct type of games you buy",
              "type" : "SimpleText"
            } ]
          } ]
        }, {
          "type" : "ListItem",
          "content" : [ {
            "type" : "Paragraph",
            "content" : [ {
              "text" : "each distinct game type will yield 10% discount, as long as games cost more than $15",
              "type" : "SimpleText"
            } ]
          } ]
        }, {
          "type" : "ListItem",
          "content" : [ {
            "type" : "Paragraph",
            "content" : [ {
              "text" : "no more than three distinct games types will be counted",
              "type" : "SimpleText"
            } ]
          } ]
        } ]
      }, {
        "type" : "Paragraph",
        "content" : [ {
          "text" : "As an example, given the following checkout cart, a user will get a 20% discount:",
          "type" : "SimpleText"
        } ]
      }, {
        "table" : {
          "columns" : [ {
            "title" : "id"
          }, {
            "title" : "type"
          }, {
            "title" : "price"
          } ],
          "data" : [ [ [ {
            "type" : "Paragraph",
            "content" : [ {
              "text" : "g1",
              "type" : "SimpleText"
            } ]
          } ], [ {
            "type" : "Paragraph",
            "content" : [ {
              "text" : "RPG",
              "type" : "SimpleText"
            } ]
          } ], [ {
            "type" : "Paragraph",
            "content" : [ {
              "text" : "10",
              "type" : "SimpleText"
            } ]
          } ] ], [ [ {
            "type" : "Paragraph",
            "content" : [ {
              "text" : "g2",
              "type" : "SimpleText"
            } ]
          } ], [ {
            "type" : "Paragraph",
            "content" : [ {
              "text" : "RPG",
              "type" : "SimpleText"
            } ]
          } ], [ {
            "type" : "Paragraph",
            "content" : [ {
              "text" : "50",
              "type" : "SimpleText"
            } ]
          } ] ], [ [ {
            "type" : "Paragraph",
            "content" : [ {
              "text" : "g3",
              "type" : "SimpleText"
            } ]
          } ], [ {
            "type" : "Paragraph",
            "content" : [ {
              "text" : "Action",
              "type" : "SimpleText"
            } ]
          } ], [ {
            "type" : "Paragraph",
            "content" : [ {
              "text" : "70",
              "type" : "SimpleText"
            } ]
          } ] ], [ [ {
            "type" : "Paragraph",
            "content" : [ {
              "text" : "g4",
              "type" : "SimpleText"
            } ]
          } ], [ {
            "type" : "Paragraph",
            "content" : [ {
              "text" : "Puzzle",
              "type" : "SimpleText"
            } ]
          } ], [ {
            "type" : "Paragraph",
            "content" : [ {
              "text" : "10",
              "type" : "SimpleText"
            } ]
          } ] ] ]
        },
        "highlightRowIndexes" : [ 1, 2 ],
        "title" : "games discount example  ",
        "anchorId" : "business-logic-data-preparation-games-discount-example",
        "type" : "Table"
      }, {
        "type" : "Paragraph",
        "content" : [ {
          "text" : "Let's create a discount calculator to implement the business rule:",
          "type" : "SimpleText"
        } ]
      }, {
        "lang" : "java",
        "snippet" : "public class DiscountCalculator {\n    public int calculateDiscountPercentage(List<Game> games) {\n        long numberOfDistinctTypes = games.stream()\n                .filter(game -> game.getPriceUsd().compareTo(BigDecimal.valueOf(15)) > 0) // price filter\n                .map(Game::getType)\n                .distinct() // only distinct game types\n                .count();\n\n        long limitedDistinctTypes = Math.min(3, numberOfDistinctTypes); // no more than three\n        return (int) (limitedDistinctTypes * 10);\n    }\n}",
        "title" : "discount calculator",
        "entry" : "DiscountCalculator",
        "commentsType" : "inline",
        "anchorId" : "business-logic-data-preparation-discount-calculator",
        "type" : "Snippet"
      }, {
        "type" : "Paragraph",
        "content" : [ {
          "text" : "To test that code we will need to create a sufficient number of ",
          "type" : "SimpleText"
        }, {
          "code" : "Game",
          "type" : "InlinedCode"
        }, {
          "text" : " instances to make sure we cover:",
          "type" : "SimpleText"
        } ]
      }, {
        "presentationBulletListType" : "RevealBoxes",
        "type" : "Meta"
      }, {
        "bulletMarker" : "*",
        "tight" : true,
        "type" : "BulletList",
        "content" : [ {
          "type" : "ListItem",
          "content" : [ {
            "type" : "Paragraph",
            "content" : [ {
              "text" : "Count only one game per type",
              "type" : "SimpleText"
            } ]
          } ]
        }, {
          "type" : "ListItem",
          "content" : [ {
            "type" : "Paragraph",
            "content" : [ {
              "text" : "Count only games with ",
              "type" : "SimpleText"
            }, {
              "type" : "Emphasis",
              "content" : [ {
                "text" : "high enough price",
                "type" : "SimpleText"
              } ]
            } ]
          } ]
        }, {
          "type" : "ListItem",
          "content" : [ {
            "type" : "Paragraph",
            "content" : [ {
              "text" : "Should count no more than ",
              "type" : "SimpleText"
            }, {
              "type" : "Emphasis",
              "content" : [ {
                "text" : "three distinct types",
                "type" : "SimpleText"
              } ]
            } ]
          } ]
        } ]
      }, {
        "type" : "Paragraph",
        "content" : [ {
          "text" : "Creating many ",
          "type" : "SimpleText"
        }, {
          "code" : "Game",
          "type" : "InlinedCode"
        }, {
          "text" : " instances is a lot of boilerplate:",
          "type" : "SimpleText"
        } ]
      }, {
        "lang" : "java",
        "snippet" : "Game game1 = new Game();\ngame1.setId(\"id1\");\ngame1.setType(\"RPG\");\ngame1.setPriceUsd(BigDecimal.valueOf(12));\n\nGame game2 = new Game();\ngame1.setId(\"id2\");\ngame1.setType(\"RPG\");\ngame1.setPriceUsd(BigDecimal.valueOf(28));\n\nGame game3 = new Game();\ngame1.setId(\"id3\");\ngame1.setType(\"RPG\");\ngame1.setPriceUsd(BigDecimal.valueOf(70));\n\n// ....\n\nList<Game> checkoutGames = Arrays.asList(game1, game2, game3);",
        "title" : "boilerplate",
        "entry" : "longObjectsCreation",
        "bodyOnly" : true,
        "anchorId" : "business-logic-data-preparation-boilerplate",
        "type" : "Snippet"
      }, {
        "type" : "Paragraph",
        "content" : [ {
          "text" : "When we deal with boilerplate multiple things can happen:",
          "type" : "SimpleText"
        } ]
      }, {
        "bulletMarker" : "*",
        "tight" : true,
        "type" : "BulletList",
        "content" : [ {
          "type" : "ListItem",
          "content" : [ {
            "type" : "Paragraph",
            "content" : [ {
              "text" : "copy pasting and not updating values",
              "type" : "SimpleText"
            } ]
          } ]
        }, {
          "type" : "ListItem",
          "content" : [ {
            "type" : "Paragraph",
            "content" : [ {
              "text" : "not creating enough instances",
              "type" : "SimpleText"
            } ]
          } ]
        } ]
      }, {
        "type" : "Paragraph",
        "content" : [ {
          "text" : "To streamline the process of data creation, ",
          "type" : "SimpleText"
        }, {
          "code" : "WebTau",
          "type" : "InlinedCode"
        }, {
          "text" : " provides ",
          "type" : "SimpleText"
        }, {
          "code" : "table",
          "type" : "InlinedCode"
        }, {
          "text" : " API:",
          "type" : "SimpleText"
        } ]
      }, {
        "lang" : "java",
        "snippet" : "public class DiscountCalculatorTest {\n    @Test\n    public void discountBasedUniqueGenresAbove15DollarsLimitedBy3() {\n        List<Game> checkoutGames = createGames(table(\"id\"     , \"type\", \"price\", // WebTau table API to create domain data\n                                                     ___________________________,\n                                                     cell.guid, \"RPG\",   12, // cell.guid generated unique id for each row\n                                                     cell.guid, \"RPG\",   28,\n                                                     cell.guid, \"RPG\",   70, // three games with the same Type to make sure we pick only one distinct even though 2 match price criteria\n                                                     cell.guid, \"FPS\",   30,\n                                                     cell.guid, \"FPS\",   10,\n                                                     cell.guid, \"RTS\",   60,\n                                                     cell.guid, \"Sport\", 30)); // extra game type to make sure we stop at 3\n\n        int discountPercentage = new DiscountCalculator().calculateDiscountPercentage(checkoutGames);\n        actual(discountPercentage, \"discount\").should(equal(30)); // validate the result\n    }\n}",
        "title" : "discount calculator test",
        "entry" : "DiscountCalculatorTest",
        "commentsType" : "inline",
        "exclude" : "doc-exclude",
        "anchorId" : "business-logic-data-preparation-discount-calculator-test",
        "type" : "Snippet"
      }, {
        "type" : "Paragraph",
        "content" : [ {
          "text" : "Let's take a look at implementation of ",
          "type" : "SimpleText"
        }, {
          "code" : "createGames",
          "type" : "InlinedCode"
        }, {
          "text" : ":",
          "type" : "SimpleText"
        } ]
      }, {
        "lang" : "java",
        "snippet" : "public static List<Game> createGames(TableData table) { // table data is like list of map\n    return table.rowsStream() // you can stream rows\n            .map(GamesData::createGame)\n            .collect(Collectors.toList());\n}\n\npublic static Game createGame(Record row) {\n    Game game = new Game();\n    game.setId(row.get(\"id\"));\n    game.setType(row.get(\"type\"));\n    game.setTitle(row.get(\"title\", \"\")); // default values when not provided\n    game.setPriceUsd(BigDecimal.valueOf((int) row.get(\"price\", 0)));\n\n    return game; // and create domain data you need\n}",
        "title" : "create games",
        "entry" : [ "createGames", "createGame" ],
        "entrySeparator" : "",
        "commentsType" : "inline",
        "anchorId" : "business-logic-data-preparation-create-games",
        "type" : "Snippet"
      }, {
        "type" : "Paragraph",
        "content" : [ {
          "text" : "By using ",
          "type" : "SimpleText"
        }, {
          "code" : "table",
          "type" : "InlinedCode"
        }, {
          "text" : " and a domain specific methods like ",
          "type" : "SimpleText"
        }, {
          "code" : "createGames",
          "type" : "InlinedCode"
        }, {
          "text" : " you make your tests easier to write, read and maintain.",
          "type" : "SimpleText"
        } ]
      } ]
    }, {
      "id" : "business-logic-data-validation",
      "title" : "Business Logic Data Validation",
      "type" : "Section",
      "content" : [ {
        "type" : "Paragraph",
        "content" : [ {
          "text" : "We just simplified our data creation process. Now let's see how we can simplify data validation one.",
          "type" : "SimpleText"
        } ]
      }, {
        "presentationParagraph" : "default",
        "type" : "Meta"
      }, {
        "type" : "Paragraph",
        "content" : [ {
          "text" : "This time we will test a ",
          "type" : "SimpleText"
        }, {
          "type" : "Emphasis",
          "content" : [ {
            "text" : "recommendation engine",
            "type" : "SimpleText"
          } ]
        }, {
          "text" : ". One of its role is to provide a new game to play based on the games you already played.",
          "type" : "SimpleText"
        }, {
          "type" : "SoftLineBreak"
        }, {
          "text" : "For now the engine will recommend the least played game in the least played type of games.",
          "type" : "SimpleText"
        } ]
      }, {
        "type" : "Paragraph",
        "content" : [ {
          "text" : "Here is the test:",
          "type" : "SimpleText"
        } ]
      }, {
        "presentationParagraph" : "",
        "type" : "Meta"
      }, {
        "lang" : "java",
        "snippet" : "public class GameRecommendationEngineTest {\n    @Test\n    public void shouldRecommendNextGameWhereAccumulatedPerTypeIsLowest() {\n        GamesLibrary library = createLibrary(table(\"id\",  \"type\",      \"title\", \"hoursPlayed\", // create game library with play stats\n                                                   _________________________________________,\n                                                   \"g1\",   \"RPG\", \"Divinity 2\", 130,\n                                                   \"g2\", \"Sport\",   \"NBA 2023\",   1,\n                                                   \"g3\",  \"JRPG\",  \"Persona 5\", 300));\n\n        GameRecommendationEngine engine = new GameRecommendationEngine(library);\n\n        actual(engine.recommendNextGame(), \"nextGame\").should(equal(map( // assert on Game bean using map\n                \"id\", \"g2\",\n                \"type\", \"Sport\",\n                \"title\", contain(\"2023\"), // using a matcher for a field\n                \"stats\", map(\"hoursPlayed\", 1))));\n    }\n}",
        "title" : "recommendation logic test",
        "entry" : "GameRecommendationEngineTest",
        "commentsType" : "inline",
        "exclude" : "doc-exclude",
        "anchorId" : "business-logic-data-validation-recommendation-logic-test",
        "type" : "Snippet"
      }, {
        "type" : "Paragraph",
        "content" : [ {
          "text" : "Our current implementation has a bug, and uses incorrect ",
          "type" : "SimpleText"
        }, {
          "code" : "type",
          "type" : "InlinedCode"
        }, {
          "text" : " for the returned game.",
          "type" : "SimpleText"
        }, {
          "type" : "SoftLineBreak"
        }, {
          "text" : "When mismatch occurs, WebTau output provides all the information you need to understand the issue and highlights important parts of the output:",
          "type" : "SimpleText"
        } ]
      }, {
        "title" : "console output",
        "revealLineStop" : [ 0, 3 ],
        "highlight" : [ 10 ],
        "lines" : [ "\u001B[31mX \u001B[31mfailed \u001B[34mexpecting \u001B[0m\u001B[1mnextGame \u001B[0m\u001B[34mto equal \u001B[33m{\u001B[35m\"id\"\u001B[33m: \u001B[32m\"g2\"\u001B[33m, \u001B[35m\"type\"\u001B[33m: \u001B[32m\"Sport\"\u001B[33m, \u001B[35m\"title\"\u001B[33m: \u001B[36m<contain \"2023\">\u001B[33m, \u001B[35m\"stats\"\u001B[33m: \u001B[33m{\u001B[35m\"hoursPlayed\"\u001B[33m: \u001B[34m1\u001B[33m}\u001B[33m}\u001B[0m:\u001B[0m", "\u001B[0m    \u001B[0m\u001B[1mnextGame.type\u001B[0m:\u001B[0m  \u001B[36mactual\u001B[0m:\u001B[0m \u001B[32m\"RPG\"\u001B[0m \u001B[33m<java.lang.String>\u001B[0m", "\u001B[0m    \u001B[0m              \u001B[36mexpected\u001B[0m: \u001B[32m\"Sport\"\u001B[0m \u001B[33m<java.lang.String>\u001B[0m", "\u001B[0m    \u001B[0m              \u001B[0m           ^\u001B[33m (\u001B[32m39ms\u001B[33m)\u001B[0m", "  \u001B[0m", "  \u001B[33m{\u001B[0m", "    \u001B[35m\"id\"\u001B[33m: \u001B[32m\"g2\"\u001B[33m,\u001B[0m", "    \u001B[35m\"priceUsd\"\u001B[33m: \u001B[36mnull\u001B[33m,\u001B[0m", "    \u001B[35m\"stats\"\u001B[33m: \u001B[33m{\u001B[35m\"gameId\"\u001B[33m: \u001B[32m\"g2\"\u001B[33m, \u001B[35m\"hoursPlayed\"\u001B[33m: \u001B[34m1\u001B[33m}\u001B[33m,\u001B[0m", "    \u001B[35m\"title\"\u001B[33m: \u001B[32m\"NBA 2023\"\u001B[33m,\u001B[0m", "    \u001B[35m\"type\"\u001B[33m: \u001B[31m**\"RPG\"**\u001B[0m", "  \u001B[33m}\u001B[0m" ],
        "anchorId" : "business-logic-data-validation-console-output",
        "type" : "CliOutput"
      }, {
        "type" : "Paragraph",
        "content" : [ {
          "code" : "WebTau",
          "type" : "InlinedCode"
        }, {
          "text" : " did good with an object validation with a nested object. Let's take a look at how it fares with a list of objects.",
          "type" : "SimpleText"
        } ]
      }, {
        "presentationParagraph" : "default",
        "type" : "Meta"
      }, {
        "type" : "Paragraph",
        "content" : [ {
          "text" : "Games Library class has a method to find top N games. It returns a list of games. Let's test it.",
          "type" : "SimpleText"
        } ]
      }, {
        "presentationParagraph" : "",
        "type" : "Meta"
      }, {
        "lang" : "java",
        "snippet" : "public class GamesLibraryTest {\n  @Test\n  public void shouldFindTopTwoGames() {\n    GamesLibrary library = createLibrary(table(\"id\",        \"type\",      \"title\", \"hoursPlayed\", \"price\",\n                                               _________________________________________________________,\n                                               \"g1\",         \"RPG\",  \"Divinity 2\", 130,           30,\n                                               \"g2\",       \"Sport\",    \"NBA 2023\",   1,           40,\n                                               \"g3\",        \"JRPG\",   \"Persona 5\", 300,           20,\n                                               \"g4\",  \"PainAction\",  \"Elden Ring\", 200,           60));\n    trace(\"all games\", propertiesTable(library.getGames())); // tracing all games when need to debug\n\n    List<Game> topTwoGames = library.findTopNGames(2); // find top two games as list of game\n\n    TableData expected = table( \"*id\",        \"type\",      \"title\", \"priceUsd\"   ,  \"stats\",  // expectation as table with key column <id>\n                               _____________________________________________________________________________,\n                                 \"g3\",        \"JRPG\",   \"Persona 5\", lessThan(60), map(\"hoursPlayed\", 300), // using a matcher inside a table cell\n                                 \"g4\",  \"PainAction\",  \"Elden Ring\",          60 , map(\"hoursPlayed\", 200));\n\n    actual(topTwoGames, \"top2\").should(equal(expected)); // compare with list of java beans order agnostic\n  }\n}",
        "title" : "top two games test",
        "entry" : "GamesLibraryTest",
        "commentsType" : "inline",
        "exclude" : "doc-exclude",
        "anchorId" : "business-logic-data-validation-top-two-games-test",
        "type" : "Snippet"
      }, {
        "title" : "console output",
        "revealLineStop" : [ 0, 5, 8, 12 ],
        "highlight" : [ 15, 16 ],
        "lines" : [ "\u001B[1m[tracing]\u001B[0m \u001B[34mall games\u001B[0m", "  \u001B[35mid  \u001B[33m │ \u001B[35mpriceUsd\u001B[33m │ \u001B[35mstats                               \u001B[33m │ \u001B[35mtitle       \u001B[33m │ \u001B[35mtype        \u001B[0m", "  \u001B[32m\"g1\"\u001B[33m │ \u001B[36mnull    \u001B[33m │ \u001B[33m{\u001B[35m\"gameId\"\u001B[33m: \u001B[32m\"g1\"\u001B[33m, \u001B[35m\"hoursPlayed\"\u001B[33m: \u001B[34m130\u001B[33m}\u001B[33m │ \u001B[32m\"Divinity 2\"\u001B[33m │ \u001B[32m\"RPG\"       \u001B[0m", "  \u001B[32m\"g2\"\u001B[33m │ \u001B[36mnull    \u001B[33m │ \u001B[33m{\u001B[35m\"gameId\"\u001B[33m: \u001B[32m\"g2\"\u001B[33m, \u001B[35m\"hoursPlayed\"\u001B[33m: \u001B[34m1\u001B[33m}  \u001B[33m │ \u001B[32m\"NBA 2023\"  \u001B[33m │ \u001B[32m\"Sport\"     \u001B[0m", "  \u001B[32m\"g3\"\u001B[33m │ \u001B[36mnull    \u001B[33m │ \u001B[33m{\u001B[35m\"gameId\"\u001B[33m: \u001B[32m\"g3\"\u001B[33m, \u001B[35m\"hoursPlayed\"\u001B[33m: \u001B[34m300\u001B[33m}\u001B[33m │ \u001B[32m\"Persona 5\" \u001B[33m │ \u001B[32m\"JRPG\"      \u001B[0m", "  \u001B[32m\"g4\"\u001B[33m │ \u001B[36mnull    \u001B[33m │ \u001B[33m{\u001B[35m\"gameId\"\u001B[33m: \u001B[32m\"g4\"\u001B[33m, \u001B[35m\"hoursPlayed\"\u001B[33m: \u001B[34m200\u001B[33m}\u001B[33m │ \u001B[32m\"Elden Ring\"\u001B[33m │ \u001B[32m\"PainAction\"\u001B[0m", "\u001B[31mX \u001B[31mfailed \u001B[34mexpecting \u001B[0m\u001B[1mtop2 \u001B[0m\u001B[34mto equal \u001B[33m*\u001B[35mid \u001B[33m │ \u001B[35mtype        \u001B[33m │ \u001B[35mtitle       \u001B[33m │ \u001B[35mpriceUsd      \u001B[33m │ \u001B[35mstats               ", "                                 \u001B[32m\"g3\"\u001B[33m │ \u001B[32m\"JRPG\"      \u001B[33m │ \u001B[32m\"Persona 5\" \u001B[33m │ \u001B[36m<less than 60>\u001B[33m │ \u001B[33m{\u001B[35m\"hoursPlayed\"\u001B[33m: \u001B[34m300\u001B[33m}", "                                 \u001B[32m\"g4\"\u001B[33m │ \u001B[32m\"PainAction\"\u001B[33m │ \u001B[32m\"Elden Ring\"\u001B[33m │             \u001B[34m60\u001B[33m │ \u001B[33m{\u001B[35m\"hoursPlayed\"\u001B[33m: \u001B[34m200\u001B[33m}\u001B[0m:\u001B[0m", "\u001B[0m    \u001B[0m\u001B[1mtop2[0].priceUsd\u001B[0m:\u001B[0m  \u001B[36mactual\u001B[0m: \u001B[31mnull\u001B[0m", "\u001B[0m    \u001B[0m                 \u001B[36mexpected\u001B[0m: \u001B[36m<less than 60>\u001B[0m \u001B[33m<org.testingisdocumenting.webtau.expectation.equality.LessThanMatcher>\u001B[0m", "\u001B[0m    \u001B[0m\u001B[1mtop2[1].priceUsd\u001B[0m:\u001B[0m  \u001B[36mactual\u001B[0m: \u001B[31mnull\u001B[0m", "\u001B[0m    \u001B[0m                 \u001B[36mexpected\u001B[0m: \u001B[34m60\u001B[0m \u001B[33m<java.lang.Integer>\u001B[33m (\u001B[32m10ms\u001B[33m)\u001B[0m", "  \u001B[0m", "  \u001B[35mid  \u001B[33m │ \u001B[35mpriceUsd\u001B[33m │ \u001B[35mstats                               \u001B[33m │ \u001B[35mtitle       \u001B[33m │ \u001B[35mtype        \u001B[0m", "  \u001B[32m\"g3\"\u001B[33m │ \u001B[31m**null**\u001B[33m │ \u001B[33m{\u001B[35m\"gameId\"\u001B[33m: \u001B[32m\"g3\"\u001B[33m, \u001B[35m\"hoursPlayed\"\u001B[33m: \u001B[34m300\u001B[33m}\u001B[33m │ \u001B[32m\"Persona 5\" \u001B[33m │ \u001B[32m\"JRPG\"      \u001B[0m", "  \u001B[32m\"g4\"\u001B[33m │ \u001B[31m**null**\u001B[33m │ \u001B[33m{\u001B[35m\"gameId\"\u001B[33m: \u001B[32m\"g4\"\u001B[33m, \u001B[35m\"hoursPlayed\"\u001B[33m: \u001B[34m200\u001B[33m}\u001B[33m │ \u001B[32m\"Elden Ring\"\u001B[33m │ \u001B[32m\"PainAction\"\u001B[0m" ],
        "anchorId" : "business-logic-data-validation-console-output-2",
        "type" : "CliOutput"
      }, {
        "presentationParagraph" : "default",
        "type" : "Meta"
      }, {
        "type" : "Paragraph",
        "content" : [ {
          "text" : "Using ",
          "type" : "SimpleText"
        }, {
          "code" : "trace",
          "type" : "InlinedCode"
        }, {
          "text" : " method is optional and can be helpful when dealing with complex data to see what's going on.",
          "type" : "SimpleText"
        }, {
          "type" : "SoftLineBreak"
        }, {
          "text" : "When failure happens, ",
          "type" : "SimpleText"
        }, {
          "code" : "WebTau",
          "type" : "InlinedCode"
        }, {
          "text" : " displays actual complex data and highlights values within that you need to take a look at.",
          "type" : "SimpleText"
        } ]
      }, {
        "type" : "Paragraph",
        "content" : [ {
          "text" : "We did validation using ",
          "type" : "SimpleText"
        }, {
          "code" : "TableData",
          "type" : "InlinedCode"
        }, {
          "text" : ".",
          "type" : "SimpleText"
        }, {
          "type" : "HardLineBreak"
        }, {
          "text" : "Let's take a look at how a property by property validation would look like.",
          "type" : "SimpleText"
        } ]
      }, {
        "presentationParagraph" : "",
        "type" : "Meta"
      }, {
        "lang" : "java",
        "snippet" : "List<Game> topTwoGames = library.findTopNGames(2);\n\nGame gameOne = topTwoGames.get(0);\nassertEquals(\"g3\",  gameOne.getId());\nassertEquals(\"JRPG\",  gameOne.getType());\nassertEquals(\"Persona 5\",  gameOne.getTitle());\nassertEquals(BigDecimal.valueOf(20),  gameOne.getPriceUsd());\nassertEquals(300,  gameOne.getStats().getHoursPlayed());\n\nGame gameTwo = topTwoGames.get(1);\nassertEquals(\"g3\",  gameOne.getId());\nassertEquals(\"PainAction\",  gameOne.getType());\nassertEquals(\"Elden Ring\",  gameOne.getTitle());\nassertEquals(BigDecimal.valueOf(60),  gameOne.getPriceUsd());\nassertEquals(200,  gameOne.getStats().getHoursPlayed());",
        "title" : "property by property validation",
        "surroundedBy" : "games-validation",
        "meta" : {
          "stickySlide" : "top"
        },
        "anchorId" : "business-logic-data-validation-property-by-property-validation",
        "type" : "Snippet"
      }, {
        "type" : "Paragraph",
        "content" : [ {
          "text" : "To contrast it with ",
          "type" : "SimpleText"
        }, {
          "code" : "table",
          "type" : "InlinedCode"
        }, {
          "text" : " approach:",
          "type" : "SimpleText"
        } ]
      }, {
        "lang" : "java",
        "snippet" : "TableData expected = table( \"*id\",        \"type\",      \"title\", \"priceUsd\"   ,  \"stats\",  // expectation as table with key column <id>\n                           _____________________________________________________________________________,\n                             \"g3\",        \"JRPG\",   \"Persona 5\", lessThan(60), map(\"hoursPlayed\", 300), // using a matcher inside a table cell\n                             \"g4\",  \"PainAction\",  \"Elden Ring\",          60 , map(\"hoursPlayed\", 200));",
        "title" : "table data validation",
        "startLine" : "TableData expected",
        "endLine" : "));",
        "commentsType" : "remove",
        "anchorId" : "business-logic-data-validation-table-data-validation",
        "type" : "Snippet"
      }, {
        "type" : "Paragraph",
        "content" : [ {
          "text" : "When dealing with validation boilerplate code you can face even worse problems than with data preparation:",
          "type" : "SimpleText"
        } ]
      }, {
        "bulletMarker" : "*",
        "tight" : true,
        "type" : "BulletList",
        "content" : [ {
          "type" : "ListItem",
          "content" : [ {
            "type" : "Paragraph",
            "content" : [ {
              "text" : "ignore certain fields validation",
              "type" : "SimpleText"
            } ]
          } ]
        }, {
          "type" : "ListItem",
          "content" : [ {
            "type" : "Paragraph",
            "content" : [ {
              "text" : "copy and paste wrong values and they match incorrect logic",
              "type" : "SimpleText"
            } ]
          } ]
        } ]
      } ]
    }, {
      "id" : "rest-api-and-database",
      "title" : "REST API And Database",
      "type" : "Section",
      "content" : [ {
        "type" : "Paragraph",
        "content" : [ {
          "text" : "We tested some business logic and now lets move on to REST API testing. Game server exposes ",
          "type" : "SimpleText"
        }, {
          "code" : "/api/game",
          "type" : "InlinedCode"
        }, {
          "text" : " end-point to list available games.",
          "type" : "SimpleText"
        }, {
          "type" : "SoftLineBreak"
        }, {
          "text" : "To test it, we will manually insert records into ",
          "type" : "SimpleText"
        }, {
          "code" : "GAME",
          "type" : "InlinedCode"
        }, {
          "text" : " database table and then use ",
          "type" : "SimpleText"
        }, {
          "code" : "http.get",
          "type" : "InlinedCode"
        }, {
          "text" : " request to validate a piece of data.",
          "type" : "SimpleText"
        } ]
      }, {
        "title" : "REST API response",
        "data" : [ {
          "id" : "id1",
          "title" : "Game One",
          "type" : "RPG",
          "priceUsd" : 20.0
        }, {
          "id" : "id2",
          "title" : "Game Two",
          "type" : "FPS",
          "priceUsd" : 40.0
        } ],
        "paths" : [ ],
        "anchorId" : "rest-api-and-database-rest-api-response",
        "type" : "Json"
      }, {
        "lang" : "java",
        "snippet" : "public class GameRestTest {\n    private final DatabaseTable GAME = db.table(\"GAME\"); // declare GAME table\n\n    @Test\n    public void fetchListOfGames() {\n        GAME.clear(); // remove all entries from the DB table\n        GAME.insert(table(\"id\",  \"title\",  \"type\", \"priceUsd\", // insert two rows with auto conversion from camelCase to SNAKE_CASE\n                          __________________________________,\n                         \"id1\", \"Game One\", \"RPG\", 20,\n                         \"id2\", \"Game Two\", \"FPS\", 40));\n\n        trace(\"games from DB\", GAME.query().tableData()); // trace data from DB\n\n        http.get(\"/api/game\", (header, body) -> { // GET call\n            body.get(0).get(\"type\").should(equal(\"RPG\")); // specific field validation\n            body.should(equal(table(\"*id\", \"title\",  // bulk validation\n                                  _____________________,\n                                     \"id1\", \"Game One\",\n                                     \"id2\", \"Game Two\")));\n        });\n    }\n}",
        "title" : "create DB entries and query with REST API",
        "entry" : "GameRestTest",
        "commentsType" : "inline",
        "exclude" : "doc-exclude",
        "meta" : {
          "stickySlide" : "left 35%"
        },
        "anchorId" : "rest-api-and-database-create-db-entries-and-query-with-rest-api",
        "type" : "Snippet"
      }, {
        "title" : "console output",
        "highlight" : [ 1, 5, 8, 12, 17, 19, 24 ],
        "lines" : [ "\u001B[33m> \u001B[34mcreating \u001B[36mdb datasource \u001B[0m\u001B[1mprimary\u001B[0m", "\u001B[32m. \u001B[34mcreated \u001B[36mdb datasource \u001B[0m\u001B[1mprimary\u001B[33m (\u001B[32m94ms\u001B[33m)\u001B[0m", "\u001B[33m> \u001B[34mrunning DB update \u001B[33mdelete from GAME \u001B[33mon \u001B[0m\u001B[1mprimary-db\u001B[0m", "\u001B[32m. \u001B[34mran DB update \u001B[33mdelete from GAME \u001B[33mon \u001B[0m\u001B[1mprimary-db \u001B[34maffected \u001B[34m2 \u001B[36mrows\u001B[33m (\u001B[32m13ms\u001B[33m)\u001B[0m", "\u001B[33m> \u001B[34minserting \u001B[34m2 \u001B[34mrows \u001B[33minto \u001B[0m\u001B[1mprimary-db.GAME\u001B[0m", "\u001B[32m. \u001B[34minserted \u001B[34m2 \u001B[34mrows \u001B[33minto \u001B[0m\u001B[1mprimary-db.GAME\u001B[33m (\u001B[32m10ms\u001B[33m)\u001B[0m", "\u001B[33m> \u001B[34mrunning DB query \u001B[32mSELECT * FROM GAME \u001B[33mon \u001B[0m\u001B[1mprimary-db\u001B[0m", "\u001B[32m. \u001B[34mran DB query \u001B[32mSELECT * FROM GAME \u001B[33mon \u001B[0m\u001B[1mprimary-db\u001B[33m (\u001B[32m6ms\u001B[33m)\u001B[0m", "\u001B[1m[tracing]\u001B[0m \u001B[34mgames from DB\u001B[0m", "  \u001B[35mID   \u001B[33m │ \u001B[35mPRICE_USD\u001B[33m │ \u001B[35mTITLE     \u001B[33m │ \u001B[35mTYPE \u001B[0m", "  \u001B[32m\"id1\"\u001B[33m │     \u001B[34m20.00\u001B[33m │ \u001B[32m\"Game One\"\u001B[33m │ \u001B[32m\"RPG\"\u001B[0m", "  \u001B[32m\"id2\"\u001B[33m │     \u001B[34m40.00\u001B[33m │ \u001B[32m\"Game Two\"\u001B[33m │ \u001B[32m\"FPS\"\u001B[0m", "\u001B[33m> \u001B[34mexecuting HTTP \u001B[36mGET \u001B[35mhttp://localhost:8080/api/game\u001B[0m", "  \u001B[32m. \u001B[0m\u001B[1mbody[0].type \u001B[0m\u001B[34mequals \u001B[32m\"RPG\"\u001B[33m (\u001B[32m0ms\u001B[33m)\u001B[0m", "  \u001B[32m. \u001B[0m\u001B[1mbody \u001B[0m\u001B[34mequals \u001B[33m*\u001B[35mid  \u001B[33m │ \u001B[35mtitle     ", "                \u001B[32m\"id1\"\u001B[33m │ \u001B[32m\"Game One\"", "                \u001B[32m\"id2\"\u001B[33m │ \u001B[32m\"Game Two\"\u001B[33m (\u001B[32m1ms\u001B[33m)\u001B[0m", "  \u001B[32m. \u001B[0m\u001B[1mheader.statusCode \u001B[0m\u001B[34mequals \u001B[34m200\u001B[33m (\u001B[32m1ms\u001B[33m)\u001B[0m", "  \u001B[0m", "  \u001B[33mresponse\u001B[36m (application/json):\u001B[0m", "  \u001B[33m[\u001B[0m", "    \u001B[33m{\u001B[35m\"id\"\u001B[33m: \u001B[1m\u001B[32m__\"id1\"__\u001B[33m, \u001B[35m\"title\"\u001B[33m: \u001B[1m\u001B[32m__\"Game One\"__\u001B[33m, \u001B[35m\"type\"\u001B[33m: \u001B[1m\u001B[32m__\"RPG\"__\u001B[33m, \u001B[35m\"priceUsd\"\u001B[33m: \u001B[34m20.0\u001B[33m}\u001B[33m,\u001B[0m", "    \u001B[33m{\u001B[35m\"id\"\u001B[33m: \u001B[1m\u001B[32m__\"id2\"__\u001B[33m, \u001B[35m\"title\"\u001B[33m: \u001B[1m\u001B[32m__\"Game Two\"__\u001B[33m, \u001B[35m\"type\"\u001B[33m: \u001B[32m\"FPS\"\u001B[33m, \u001B[35m\"priceUsd\"\u001B[33m: \u001B[34m40.0\u001B[33m}\u001B[0m", "  \u001B[33m]\u001B[0m", "\u001B[32m. \u001B[34mexecuted HTTP \u001B[36mGET \u001B[35mhttp://localhost:8080/api/game\u001B[33m (\u001B[32m276ms\u001B[33m)\u001B[0m" ],
        "anchorId" : "rest-api-and-database-console-output",
        "type" : "CliOutput"
      } ]
    }, {
      "id" : "reporting",
      "title" : "Reporting",
      "type" : "Section",
      "content" : [ {
        "type" : "Paragraph",
        "content" : [ {
          "text" : "As you may have noticed, WebTau produces a lot of useful output to the console.",
          "type" : "SimpleText"
        }, {
          "type" : "SoftLineBreak"
        }, {
          "text" : "In addition, it also generates HTML rich self-contained report. A single HTML file anyone can slack or email to your colleagues.",
          "type" : "SimpleText"
        }, {
          "type" : "SoftLineBreak"
        }, {
          "text" : "Continuous Integration can send it to a chat or put under shared file system, and it will just work.",
          "type" : "SimpleText"
        }, {
          "type" : "SoftLineBreak"
        }, {
          "text" : "On top of it, the report supports permalink navigation, so you can have a handy link to a specific portion of your test suite.",
          "type" : "SimpleText"
        } ]
      }, {
        "pixelRatio" : 2,
        "border" : true,
        "imageSrc" : "/blog/testing/img/game-report-failed-summary.png",
        "timestamp" : 1677515153000,
        "shapes" : [ ],
        "width" : 1160.0,
        "height" : 714.0,
        "type" : "AnnotatedImage"
      }, {
        "type" : "Paragraph",
        "content" : [ {
          "text" : "Even when your test passes, it still has plenty of information you can find useful. Here is an example of HTTP response fields your test validated.",
          "type" : "SimpleText"
        } ]
      }, {
        "delimiter" : ".",
        "startNumber" : 1,
        "type" : "OrderedList",
        "content" : [ {
          "type" : "ListItem",
          "content" : [ {
            "type" : "Paragraph",
            "content" : [ {
              "text" : "JSON fields your test touched are marked",
              "type" : "SimpleText"
            } ]
          } ]
        }, {
          "type" : "ListItem",
          "content" : [ {
            "type" : "Paragraph",
            "content" : [ {
              "text" : "It marks both bulk and precise field assertion",
              "type" : "SimpleText"
            } ]
          } ]
        } ]
      }, {
        "pixelRatio" : 2,
        "border" : true,
        "imageSrc" : "/blog/testing/img/game-report-http-details.png",
        "timestamp" : 1677515153000,
        "shapes" : [ {
          "invertedColors" : true,
          "x" : 942.0,
          "y" : 294.0,
          "text" : "1",
          "type" : "badge"
        }, {
          "invertedColors" : true,
          "x" : 922.0,
          "y" : 350.0,
          "text" : "2",
          "type" : "badge"
        } ],
        "width" : 1158.0,
        "height" : 708.0,
        "type" : "AnnotatedImage"
      } ]
    }, {
      "id" : "there-is-more",
      "title" : "There Is More",
      "type" : "Section",
      "content" : [ {
        "type" : "Paragraph",
        "content" : [ {
          "text" : "There are so many things WebTau can do and I want to share them with you very much. But I want to keep this article short.",
          "type" : "SimpleText"
        }, {
          "type" : "SoftLineBreak"
        }, {
          "text" : "Head over to ",
          "type" : "SimpleText"
        }, {
          "url" : "https://github.com/testingisdocumenting/webtau",
          "isFile" : false,
          "type" : "Link",
          "content" : [ {
            "text" : "WebTau GitHub",
            "type" : "SimpleText"
          } ]
        }, {
          "text" : " to learn more about",
          "type" : "SimpleText"
        } ]
      }, {
        "presentationBulletListType" : "Grid",
        "type" : "Meta"
      }, {
        "bulletMarker" : "*",
        "tight" : true,
        "type" : "BulletList",
        "content" : [ {
          "type" : "ListItem",
          "content" : [ {
            "type" : "Paragraph",
            "content" : [ {
              "text" : "REPL mode",
              "type" : "SimpleText"
            } ]
          } ]
        }, {
          "type" : "ListItem",
          "content" : [ {
            "type" : "Paragraph",
            "content" : [ {
              "text" : "HTTP Response Coverage",
              "type" : "SimpleText"
            } ]
          } ]
        }, {
          "type" : "ListItem",
          "content" : [ {
            "type" : "Paragraph",
            "content" : [ {
              "type" : "Emphasis",
              "content" : [ {
                "text" : "Open API",
                "type" : "SimpleText"
              } ]
            }, {
              "text" : " Integration",
              "type" : "SimpleText"
            } ]
          } ]
        }, {
          "type" : "ListItem",
          "content" : [ {
            "type" : "Paragraph",
            "content" : [ {
              "type" : "Emphasis",
              "content" : [ {
                "text" : "Performance",
                "type" : "SimpleText"
              } ]
            }, {
              "text" : " Metrics",
              "type" : "SimpleText"
            } ]
          } ]
        }, {
          "type" : "ListItem",
          "content" : [ {
            "type" : "Paragraph",
            "content" : [ {
              "text" : "Browser UI testing",
              "type" : "SimpleText"
            } ]
          } ]
        }, {
          "type" : "ListItem",
          "content" : [ {
            "type" : "Paragraph",
            "content" : [ {
              "text" : "GraphQL",
              "type" : "SimpleText"
            } ]
          } ]
        }, {
          "type" : "ListItem",
          "content" : [ {
            "type" : "Paragraph",
            "content" : [ {
              "text" : "CLI testing",
              "type" : "SimpleText"
            } ]
          } ]
        }, {
          "type" : "ListItem",
          "content" : [ {
            "type" : "Paragraph",
            "content" : [ {
              "text" : "Fake and Proxy Servers",
              "type" : "SimpleText"
            } ]
          } ]
        }, {
          "type" : "ListItem",
          "content" : [ {
            "type" : "Paragraph",
            "content" : [ {
              "text" : "Personas",
              "type" : "SimpleText"
            } ]
          } ]
        }, {
          "type" : "ListItem",
          "content" : [ {
            "type" : "Paragraph",
            "content" : [ {
              "text" : "Test Containers Integration",
              "type" : "SimpleText"
            } ]
          } ]
        } ]
      }, {
        "type" : "Paragraph",
        "content" : [ {
          "text" : "Don't be afraid by the sheer amount of things the tool can do. It is all modular, and you can use only what you need.",
          "type" : "SimpleText"
        } ]
      } ]
    }, {
      "id" : "github-and-star-webtau",
      "title" : "GitHub And Star WebTau",
      "type" : "Section",
      "content" : [ {
        "type" : "Paragraph",
        "content" : [ {
          "text" : "If you find it interesting, go to ",
          "type" : "SimpleText"
        }, {
          "url" : "https://github.com/testingisdocumenting/webtau",
          "isFile" : false,
          "type" : "Link",
          "content" : [ {
            "text" : "WebTau GitHub",
            "type" : "SimpleText"
          } ]
        }, {
          "text" : " page and star the project!",
          "type" : "SimpleText"
        } ]
      }, {
        "type" : "Paragraph",
        "content" : [ {
          "text" : "There is also a link to ",
          "type" : "SimpleText"
        }, {
          "url" : "https://discord.gg/aEHbzXTX6N",
          "isFile" : false,
          "type" : "Link",
          "content" : [ {
            "text" : "Discord Server",
            "type" : "SimpleText"
          } ]
        }, {
          "text" : " where you can ask any questions or report a bug.",
          "type" : "SimpleText"
        } ]
      } ]
    } ],
    "lastModifiedTime" : 1677515153000,
    "tocItem" : {
      "chapterTitle" : "Testing",
      "pageTitle" : "Simplified Unit And E2E testing with WebTau",
      "pageMeta" : {
        "date" : [ "2023-02-22" ],
        "title" : [ "Simplified Unit And E2E testing with WebTau" ],
        "summary" : [ "Learn how to simplify your data input and output preparation for your business and infrastructure logic." ]
      },
      "dirName" : "testing",
      "fileName" : "simplified-unit-and-e2e-testing",
      "viewOnRelativePath" : "testing/simplified-unit-and-e2e-testing.md",
      "pageSectionIdTitles" : [ {
        "title" : "Business Logic Data Preparation",
        "id" : "business-logic-data-preparation"
      }, {
        "title" : "Business Logic Data Validation",
        "id" : "business-logic-data-validation"
      }, {
        "title" : "REST API And Database",
        "id" : "rest-api-and-database"
      }, {
        "title" : "Reporting",
        "id" : "reporting"
      }, {
        "title" : "There Is More",
        "id" : "there-is-more"
      }, {
        "title" : "GitHub And Star WebTau",
        "id" : "github-and-star-webtau"
      } ]
    }
  }
}), document.getElementById("znai"));
/*-->*/

</script>

</body>
</html>
